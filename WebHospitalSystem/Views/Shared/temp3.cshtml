@model IEnumerable<WebHospitalSystem.Models.AppointmentVM>
@{
    ViewBag.Title = "Список приема пациентов";
    Layout = "~/Views/Shared/_LayoutWithoutBundles.cshtml";
}

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

<br />
<h2>Список приема пациентов</h2>
<hr />

<p>
    <input type="button" value="Запись на прием к врачу" onclick="createpopup()" />
    <input id="selectedId" type="text" hidden="hidden" />
</p>
@{
    WebGrid webGrid = new WebGrid(source: Model);
    @webGrid.GetHtml(
        htmlAttributes: new { @class = "appointmentsTable" },
        tableStyle: "table",
        columns: new[]{
            webGrid.Column(header: "ID приема", format: @<span class="label">@item.AppointmentId</span>, style: "AppointmentId" ),
webGrid.Column(null, format: @<text>@Html.Raw("<input type='button' class='appId' hidden='hidden'value="+item.AppointmentId+" '/>")</text>),

webGrid.Column("DoctorName", "ФИО врача"),
webGrid.Column("PatientName", "ФИО пациента"),
webGrid.Column("Diagnosis", "Диагноз"),
webGrid.Column(null, format: @<text>@Html.Raw("<input type='button' value=Редактировать onclick='editAppointment("+item.AppointmentId+")'/>" +
"<input type='button' value='Добавить детали' onclick='addAppointmentRecord("+item.AppointmentId+")'/>")</text>),
webGrid.Column(header: "Delete", format: @<text>@Html.ActionLink("X", "DeleteAppointment", new { appointmentId = item.AppointmentId }, new {onclick= "return confirm('Вы уверены что хотите удалить все записи относительно выбранного приема');" })</text>),
})

}
<br />
@{Html.RenderAction("ListAppointmentRecords", "Appointment");}

<div id="popup" style="display:none"></div>

<script type="text/javascript">
    function createpopup() {
        var x = $('#popup');
        x.load('/appointment/createAppointment', function () {
            x.dialog({
                show: {
                    effect: "blind",
                    duration: 1000
                },
                hide: {
                    effect: "explode",
                    duration: 1000
                },
                modal: true,
                width: 550,
                height: 600,
                title: "Запись на прием",
                resizable: false
            });
        });

    }


    function editAppointment(appointmentId) {
        var y = $('#popup');
        y.load('/appointment/editAppointment?appointmentId=' + appointmentId, function () {
            y.dialog({
                show: {
                    effect: "blind",
                    duration: 1000
                },
                hide: {
                    effect: "explode",
                    duration: 1000
                },
                modal: true,
                width: 550,
                height: 600,
                title: "Редактирование записи на прием",
                resizable: false
            });
        });
    }

    function clearSelection() {
        $("tr").each(function (index) {
            $(this).css('background', 'none');
        });
    }
    $("tr").click(function () {
        clearSelection();
        $(this).css('background', 'lightblue');
        $(this).addClass("selectedRow");

        //alert($(this).closest(".appId").attr("value"));
        //$(".selectedRow .appId").attr("value"));
        alert($(this).closest("td").find("input[type=hidden]").attr("value"));
        //$.get("?row_id=" + row_id);


    });
</script>